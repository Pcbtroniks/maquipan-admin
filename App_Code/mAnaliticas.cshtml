@using System;
@using System.Web;
@using System.IO;
@using System.Configuration;
@using MySqlConnector;

@functions{

    public static string getTotalSalesMonth()
    {
        decimal totalVentas = 0;

        using (MySqlConnection CONN = new MySqlConnection(ConfigurationManager.ConnectionStrings["SDNS"].ConnectionString))
        {
            CONN.Open();
            using (MySqlCommand CMD = new MySqlCommand("SELECT SUM(total) as totalVentas FROM ordenes WHERE MONTH(fecha) = MONTH(CURDATE()) AND YEAR(fecha) = YEAR(CURDATE()) AND estatus = 'POS';", CONN))
            {
                using (MySqlDataReader DATOS = CMD.ExecuteReader())
                {
                    if (DATOS.Read())
                    {
                        // Verifica si hay resultados antes de intentar leer el valor
                        if (!DATOS.IsDBNull(DATOS.GetOrdinal("totalVentas")))
                        {
                            totalVentas = DATOS.GetDecimal("totalVentas");
                        }
                    }
                }
            }
        }

        return totalVentas.ToString("N2");
    }




}